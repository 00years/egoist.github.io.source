<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="alternate" type="application/rss+xml" title="寂寞在唱歌" href="/atom.xml"><link rel="stylesheet" href="/css/main.css?v=10645243"><title>在终端里使用第三方登录 - 寂寞在唱歌</title><meta name="description" content="&lt;p&gt;显然你经常在网页和 APP 里使用第三方登录功能，比如用微博登录、用 QQ 登录、用 GitHub 登录，具体的方式是打开相关网页进行授权或者移动端可以利用应用内授权机制授权，那么在终端里如何操"></head><body><header class="header"><div class="avatar-wrapper"><a href="/" style="background-image:url(https://ooo.0o0.ooo/2015/10/04/56110d3a77e41.jpg)" class="avatar">EGOIST</a></div></header><div class="container"><div id="pjax" class="page"><article class="post"><header class="post-header"><h2 class="post-title">在终端里使用第三方登录</h2><div class="post-meta"><span class="post-date">2015-10-26</span><span class="post-meta-sep">-</span><span class="post-author">@EGOIST</span><span class="post-meta-sep">-</span><span class="post-count-words">null</span> words</div></header><div class="post-os">不建议使用 Windows 浏览本站，推荐用 OSX 和移动端网页访问。</div><div class="post-content markdown-body"><p>显然你经常在网页和 APP 里使用第三方登录功能，比如用微博登录、用 QQ 登录、用 GitHub 登录，具体的方式是打开相关网页进行授权或者移动端可以利用应用内授权机制授权，那么在终端里如何操作第三方账号登录呢？</p>
<p>很显然，也只能通过打开授权网页的方式获取需要的 access token 来进行操作。</p>
<h2 id="新建一个应用">新建一个应用</h2><p>常规步骤，稍后会用在这里获得的 <code>Client ID</code> 和 <code>Client Secret</code> 进行授权验证。</p>
<h2 id="思路">思路</h2><p>这些操作需要你将 API 搭建在自己的服务器上并且拥有数据库读写功能。</p>
<p>你需要用户触发登录操作之后以 POST 的方式打开一个授权网页，比如 <code>/api/login</code>，请求时在 body 中传输一个随机生成的用户 Unique ID，授权成功之后获得的 access token 和 UID 保存到数据库，在之前打开授权页面的同时 POST 请求 <code>/api/token?uid=$UID</code>，设置一个较高的 timeout 让网页不会返回超时。</p>
<p>在授权过程中由于并未获取到 token 所以让 <code>/api/token</code> 返回一个 50X 错误，判断获取到 50X 错误后用 setInterval 持续请求这个地址直到返回 200 代码，这个时候 access token 已经被你写入数据库并在这个页面上以 json 的格式输出了，于是这样你得到了需要的 access token，命令行现在可以打印出登录成功的提示信息了。</p>
</div><div class="post-ccby"> 
本文版权归 EGOIST 所有，转载请遵循 <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.zh" class="link">署名-相同方式共享 3.0 版本</a> 协议</div></article></div></div><footer class="footer">あい。</footer><div style="display:none;"><script>var host = "egoist.github.io"
if ((host == window.location.host) && (window.location.protocol != "https:"))
    window.location.protocol = "https"
var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1256487856'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/stat.php%3Fid%3D1256487856' type='text/javascript'%3E%3C/script%3E"));</script></div><script src="/js/pjax.js"></script><script src="/js/prism.js" data-manual></script><script src="/js/app.js?v=12435441"></script></body></html>